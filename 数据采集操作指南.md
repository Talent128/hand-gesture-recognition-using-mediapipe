# 手势识别数据采集通用指南

## 📋 目录
1. [准备工作](#准备工作)
2. [启动采集程序](#启动采集程序)
3. [采集操作步骤](#采集操作步骤)
4. [采集技巧](#采集技巧)
5. [常见问题](#常见问题)

---

## 🔧 准备工作

### 步骤1：确认模型结构

检查您要训练的模型类别数：

**静态手势模型**：
- 路径：`model/keypoint_classifier/static_gesture_model/`
- 标签文件：`keypoint_classifier_label.csv`

**动态手势模型**：
- 路径：`model/point_history_classifier/dynamic_gesture_model/`
- 标签文件：`point_history_classifier_label.csv`

### 步骤2：准备数据文件

确保数据文件存在：

- 静态手势：`model/keypoint_classifier/static_gesture_model/[model_name]/keypoint.csv`
- 动态手势：`model/point_history_classifier/dynamic_gesture_model/[model_name]/point_history.csv`

> **提示**：如果是新模型，程序会自动创建CSV文件

---

## 🚀 启动采集程序

### 1. 进入项目目录

```bash
cd "你的项目路径"
# 例如：cd "E:\hand gesture\hand-gesture-recognition-using-mediapipe"
```

### 2. 启动程序

```bash
python app.py
```

**程序启动后会显示**:
- 摄像头画面
- FPS 显示
- 实时手势识别结果

---

## 📊 采集操作步骤

### 界面说明

程序运行后，屏幕上会显示：

```
┌─────────────────────────────────────────┐
│  FPS: 30                                │  ← 左上角显示帧率
│                                         │
│              [摄像头画面]                 │  ← 中间显示摄像头内容
│                                         │
│  MODE: Logging Point History            │  ← 采集模式时显示
│  NUM: 3                                 │  ← 显示当前选择的类别
│                                         │
└─────────────────────────────────────────┘
```

---

### 操作按键说明

| 按键 | 功能 | 说明 |
|------|------|------|
| `n` | 正常模式 | 只识别，不采集数据 |
| `k` | **静态手势采集模式** | 采集手的形状数据⭐ |
| `h` | **动态轨迹采集模式** | 采集手指移动轨迹数据 ⭐ |
| `0-9` | 选择类别 | 选择要采集的手势类别 |
| `ESC` | 退出程序 | 关闭程序 |

> **重要提示**：按下数字键后，程序会记录**按键之前**的手势数据，而不是按键之后的数据。因此，您应该：
> 1. 先做出手势动作
> 2. 等动作完成后，再按相应的数字键保存

---

### 详细采集流程

#### 阶段1：进入采集模式

```
1. 运行程序: python app.py
2. 选择采集模式：
   - 按 'k' → 进入静态手势采集模式
   - 按 'h' → 进入动态轨迹采集模式
3. 屏幕左下角会显示相应的模式提示
```

**验证是否进入采集模式**:
- ✅ 屏幕显示 "MODE: Logging Key Point" 或 "MODE: Logging Point History"
- ✅ 可以按 0-9 选择类别

---

#### 阶段2：采集数据

**静态手势采集流程**：

```
1. 按 'k' 进入静态手势采集模式
2. 做出手势（例如：张开手掌、握拳、指向等）
3. 保持手势稳定
4. 按对应的数字键（0-9）保存当前手势
5. 数据自动保存到 CSV 文件
6. 重复步骤 2-5，采集更多样本
```

**动态轨迹采集流程**：

```
1. 按 'h' 进入轨迹采集模式
2. 做"Pointer"手势（只有食指伸出）
3. 移动手指画出轨迹（例如：圆形、直线等）
4. 移动完成后，按对应的数字键保存轨迹
5. 数据自动保存到 CSV 文件
6. 重复步骤 2-5，采集更多样本
```

> **关键点**：必须先完成手势动作，再按数字键。按键会保存之前的动作数据。

---

#### 阶段3：采集示例 - 方向识别

假设您要训练一个识别四个方向的模型，类别如下：
- 类别 3：向上移动 ⬆️
- 类别 4：向下移动 ⬇️
- 类别 5：向左移动 ⬅️
- 类别 6：向右移动 ➡️

**采集向上移动（类别3）的步骤**：

```
1. 按 'h' 进入轨迹采集模式
2. 伸出食指做"Pointer"手势
3. 从屏幕下方向上方直线移动
4. 移动完成后，按 '3' 键保存数据
5. 重复 若干（1000+） 次
```

**采集要点**：
- ✓ **速度多样性**：快速、中速、慢速都要采集
- ✓ **位置多样性**：从不同起始位置移动
- ✓ **幅度多样性**：短距离、中距离、长距离
- ✓ **方向纯粹性**：向上就是垂直向上，不要斜着

其他方向的采集方法类似，只需改变移动方向即可。

---

### 查看采集进度

在采集过程中，可以随时打开新的命令行窗口查看进度：

```bash
# 打开新的命令行窗口
# 进入项目目录
cd "你的项目路径"

# 查看采集进度
python collection_helper.py
```

**输出示例**:
```
======================================================================
           手势识别数据采集辅助工具
======================================================================

======================================================================
              🎯 动态手势数据采集统计
======================================================================
✅ 类别 0 (Stop                     ):   450 个样本
✅ 类别 1 (Clockwise                ):   520 个样本
✅ 类别 2 (Counter Clockwise        ):   510 个样本
🔄 类别 3 (Move Up                  ):   280 个样本
📝 类别 4 (Move Down                ):   120 个样本
⏳ 类别 5 (Move Left                ):    50 个样本
⏳ 类别 6 (Move Right               ):     0 个样本
======================================================================
📊 总样本数: 1930 个
📋 类别数量: 7 个
======================================================================

数据分布:
  • 最少样本类别: 0 个
  • 最多样本类别: 520 个
  • 平衡比例: 0.00%
  ⚠️  建议: 数据不平衡，建议补充样本较少的类别

----------------------------------------------------------------------

======================================================================
              ✋ 静态手势数据采集统计
======================================================================
✅ 类别 0 (Open                     ):   850 个样本
✅ 类别 1 (Close                    ):   720 个样本
✅ 类别 2 (Pointer                  ):   680 个样本
======================================================================
📊 总样本数: 2250 个
📋 类别数量: 3 个
======================================================================

数据分布:
  • 最少样本类别: 680 个
  • 最多样本类别: 850 个
  • 平衡比例: 80.00%
  ✅ 数据分布较为均衡
```

**其他查看命令**：
```bash
# 只查看动态手势进度
python collection_helper.py dynamic

# 只查看静态手势进度
python collection_helper.py static

# 查看详细统计信息
python collection_helper.py stats
```

---

## 💡 采集技巧

### 1. 环境设置

**最佳环境**:
```
✓ 光线充足（自然光或白光）
✓ 背景简洁（纯色墙壁最佳）
✓ 摄像头稳定放置
✓ 距离摄像头 30-50cm
✓ 确保手部完全在画面内
```

**避免**:
```
✗ 背光（背后有窗户）
✗ 复杂背景（图案墙纸、杂乱物品）
✗ 光线过暗或过亮
✗ 手超出画面范围
```

---

### 2. 采集节奏

**推荐节奏**:
```
1. 做手势 → 完成动作 → 按数字键保存
2. 停顿 1-2 秒
3. 重复

不要连续快速采集，容易疲劳且数据质量下降
```

**分批采集**:
```
建议每次采集 100-150 个样本后休息
- 采集 100 个 → 休息 2-3 分钟
- 查看进度，调整策略
- 继续采集下一批
```

---

### 3. 数据质量要求

**样本数量建议**：

| 手势类型 | 每个类别样本数 | 说明 |
|---------|---------------|------|
| 简单手势 | 500-800 | 容易区分的手势 |
| 复杂手势 | 800-1000 | 容易混淆的手势 |
| 特殊手势 | 1000-1500 | 需要高精度识别 |

**多样性策略**:

```
1. 速度多样性
   [慢速]────→  30%
   [中速]───→   50%
   [快速]──→    20%

2. 位置多样性
   从不同位置起始和结束

3. 幅度多样性
   [小幅]─→     20%
   [中幅]──→    60%
   [大幅]────→  20%

4. 角度多样性（对于动态手势）
   略微偏离标准方向 ±5-10°
   但不要完全改变方向
```

---

### 4. 按键时机掌握

**正确的采集时机**：

```
步骤1: 做出手势/动作
步骤2: 等待动作完成
步骤3: 按数字键保存       ← 保存的是步骤1-2的数据
步骤4: 准备下一个动作
```

**错误示例**：
```
❌ 先按数字键，再做手势 → 保存的是空数据或上一次的数据
❌ 手势做到一半就按键 → 保存的是不完整的数据
❌ 连续快速按键 → 保存重复或无效数据
```

**正确示例**：
```
✅ 伸出手指 → 画圆 → 圆完成 → 按数字键
✅ 张开手掌 → 保持稳定1秒 → 按数字键
✅ 直线移动 → 移动到终点 → 按数字键
```

---

### 5. 实时验证

在采集过程中，可以测试识别效果：

```
1. 按 'n' 键退出采集模式
2. 做手势测试识别
3. 如果识别效果不好，继续采集
4. 按 'h' 或 'k' 键重新进入采集模式
```

---

## ❓ 常见问题

### Q1: 手势没有被识别到

**原因**:
- 手部不在画面内
- 手势不标准
- 光线太暗

**解决**:
```bash
# 降低检测阈值
python app.py --min_detection_confidence 0.5
```

---

### Q2: 数据没有保存

**检查**:
1. 是否按了 'h' 或 'k' 进入采集模式
2. 是否在做完手势**之后**按的数字键
3. 控制台是否有错误提示

**验证方法**:
```bash
# 查看最新数据
python collection_helper.py

# 或直接查看CSV文件最后几行
```

---

### Q3: 采集的数据太相似

**原因**：可能是采集节奏太快，动作重复

**解决方案**：
- 增加动作的多样性
- 从不同角度、位置、速度采集
- 每次手势之间适当停顿

---

### Q4: 如何判断采集是否足够

**参考标准**：
```
1. 数量：每个类别至少 300-500 个样本
2. 平衡：最少类别和最多类别的比例 > 0.7
3. 多样性：包含不同速度、位置、幅度的样本
4. 质量：手势清晰，没有模糊或截断
```

---

## 🎯 下一步

采集完成后：

```
1. 查看最终统计:
   python collection_helper.py stats

2. 修改训练配置:
   打开对应的训练 notebook 文件
   设置正确的 NUM_CLASSES

3. 开始训练:
   执行 notebook 中的所有单元格

4. 测试新模型:
   python app.py
   测试识别效果
```



